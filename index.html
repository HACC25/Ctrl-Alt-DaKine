<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ke Ala ʻĀnuenue</title>
    <!-- 1. Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 2. Load React & ReactDOM -->
    <script
      src="https://unpkg.com/react@18/umd/react.development.js"
      crossorigin
    ></script>
    <script
      src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"
      crossorigin
    ></script>
    <!-- 3. Load Babel to transpile JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- 4. Load Lucide Icons -->
    <script src="https://unpkg.com/lucide-react@latest/dist/umd/lucide-react.js"></script>
  </head>
  <body class="bg-slate-50">
    <!-- This is where our React app will be rendered -->
    <div id="root"></div>

    <!-- 5. Our React Application Code -->
    <script type="text/babel">
      // Get React functions from the global React object
      const { useState } = React;

      // Get Icons from the global lucide object
      const {
        Bot,
        User,
        Zap,
        Send,
        Wind,
        Droplet,
        Music,
        Code,
        Loader2,
        Leaf,
        Beaker,
        Brain,
        Palette,
        X,
        Sparkles,
        AlertCircle,
        Home,
        MessageSquare,
        BookOpen,
        Users,
      } = lucide;

      // --- All our React components go here ---

      /**
       * 1. PathCard Component
       */
      const PathCard = ({ path }) => {
        const { icon: Icon, color, textColor } = path.style;

        return (
          <div className="bg-white rounded-lg shadow-lg overflow-hidden flex flex-col transform transition-all duration-300 hover:shadow-2xl hover:-translate-y-1">
            <div className={`h-3 ${color}`}></div>
            <div className="p-6 flex-1 flex flex-col">
              <div className="flex items-center space-x-4">
                <div
                  className={`w-12 h-12 rounded-full ${color} flex-shrink-0 flex items-center justify-center text-white`}
                >
                  <Icon size={24} />
                </div>
                <div>
                  <h3 className="text-xl font-bold text-gray-900">
                    {path.name}
                  </h3>
                  <p className={`font-medium text-sm ${textColor}`}>
                    {path.campuses.join(' • ')}
                  </p>
                </div>
              </div>
              <p className="mt-4 text-gray-600 flex-1">{path.description}</p>
            </div>
          </div>
        );
      };

      /**
       * 2. AiResponseBubble Component
       */
      const AiResponseBubble = ({ text, isError = false }) => (
        <div className="max-w-2xl mx-auto">
          <div className="flex items-start space-x-4">
            <div
              className={`flex-shrink-0 w-10 h-10 rounded-full ${
                isError
                  ? 'bg-red-500'
                  : 'bg-gradient-to-r from-blue-500 to-purple-600'
              } flex items-center justify-center text-white`}
            >
              {isError ? <AlertCircle size={20} /> : <Bot size={20} />}
            </div>
            <div
              className={`rounded-lg rounded-tl-none shadow-md p-4 ${
                isError ? 'bg-red-50' : 'bg-white'
              }`}
            >
              <p className={isError ? 'text-red-900' : 'text-gray-800'}>
                {text}
              </p>
            </div>
          </div>
        </div>
      );

      /**
       * 3. ChatInput Component
       */
      const ChatInput = ({ onSend, loading }) => {
        const [query, setQuery] = useState('');

        const handleSubmit = (e) => {
          e.preventDefault();
          if (query.trim() && !loading) {
            onSend(query);
            setQuery('');
          }
        };

        return (
          <footer className="sticky bottom-0 left-0 right-0 bg-white border-t border-gray-200 shadow-t-lg z-10">
            <div className="max-w-3xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
              <form
                onSubmit={handleSubmit}
                className="flex items-center space-x-3"
              >
                <input
                  type="text"
                  value={query}
                  onChange={(e) => setQuery(e.target.value)}
                  disabled={loading}
                  placeholder="e.g., 'I want to work in renewable energy'"
                  className="flex-1 w-full px-4 py-3 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50"
                />
                <button
                  type="submit"
                  disabled={loading}
                  className="w-12 h-12 flex-shrink-0 rounded-full bg-blue-600 text-white flex items-center justify-center hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:bg-gray-400"
                >
                  {loading ? (
                    <Loader2 size={20} className="animate-spin" />
                  ) : (
                    <Send size={20} />
                  )}
                </button>
              </form>
              <p className="text-xs text-center text-gray-500 mt-2">
                Demo Interface: Try 'renewable energy', 'marine animals', or
                'coding and music'.
              </p>
            </div>
          </footer>
        );
      };

      /**
       * 4. HomePage Component
       */
      const HomePage = ({ onNavigate }) => {
        return (
          <div className="min-h-screen flex flex-col bg-slate-50">
            {/* Header */}
            <header className="bg-white shadow-sm p-4">
              <div className="max-w-5xl mx-auto text-center">
                <h1 className="text-3xl font-extrabold text-gray-900">
                  Ke Ala ʻĀnuenue
                  <span className="block text-xl font-medium bg-clip-text text-transparent bg-gradient-to-r from-red-500 via-blue-500 to-purple-600">
                    The Rainbow Path
                  </span>
                </h1>
              </div>
            </header>

            {/* Hero Section */}
            <main className="flex-1 flex flex-col justify-center items-center text-center p-6">
              <div className="max-w-2xl">
                <h2 className="text-4xl sm:text-5xl font-bold text-gray-800">
                  Your journey through UH,
                </h2>
                <p className="mt-4 text-4xl sm:text-5xl font-medium text-gray-600 italic">
                  guided by culture, clarity, and AI.
                </p>
                <p className="mt-8 text-lg text-gray-500">
                  Welcome to your personalized guide for navigating the
                  University of Hawaiʻi system. Discover degree paths, see your
                  future, and find your purpose.
                </p>
                <button
                  onClick={() => onNavigate('chat')}
                  className="mt-12 inline-flex items-center justify-center px-8 py-4 border border-transparent rounded-full shadow-lg text-lg font-medium text-white bg-gradient-to-r from-blue-600 to-purple-700 hover:from-blue-700 hover:to-purple-800 transform transition-transform hover:scale-105"
                >
                  <Sparkles size={20} className="mr-3" />
                  Start Your Journey
                </button>
              </div>

              {/* Feature Placeholders */}
              <div className="max-w-5xl w-full mx-auto grid grid-cols-1 md:grid-cols-3 gap-6 mt-20">
                <div className="bg-white p-6 rounded-lg shadow-lg text-center">
                  <MessageSquare size={32} className="mx-auto text-blue-500" />
                  <h3 className="mt-4 text-xl font-semibold">AI Advisor</h3>
                  <p className="mt-2 text-gray-600">
                    Chat with our AI to find paths that match your passion.
                  </p>
                </div>
                <div className="bg-white p-6 rounded-lg shadow-lg text-center">
                  <BookOpen size={32} className="mx-auto text-green-500" />
                  <h3 className="mt-4 text-xl font-semibold">Project Info</h3>
                  <p className="mt-2 text-gray-600">
                    Learn about our vision and the tech behind this project.
                  </p>
                </div>
                <div className="bg-white p-6 rounded-lg shadow-lg text-center">
                  <Users size={32} className="mx-auto text-rose-500" />
                  <h3 className="mt-4 text-xl font-semibold">Our Team</h3>
                  <p className="mt-2 text-gray-600">
                    Meet the team building Ke Ala ʻĀnuenue.
                  </p>
                </div>
              </div>
            </main>

            <footer className="text-center p-6 text-gray-500 text-sm">
              <p>Built for UH Pathfinder AI Challenge – HACC 2025</p>
            </footer>
          </div>
        );
      };

      /**
       * 5. ChatPage Component
       */
      const ChatPage = ({ onNavigate }) => {
        const [isLoading, setIsLoading] = useState(false);
        const [aiResponse, setAiResponse] = useState('');
        const [apiError, setApiError] = useState(null);
        const [paths, setPaths] = useState([]);
        const [userQuery, setUserQuery] = useState('');

        const MOCK_PATHS = {
          renewable: [
            {
              name: 'Environmental Engineering',
              category: 'Engineering',
              description:
                'Focuses on sustainable design, water resources, and energy systems.',
              campuses: ['Mānoa'],
            },
            {
              name: 'Sustainable Science',
              category: 'Environment',
              description:
                'A broader, interdisciplinary approach covering policy, ecosystems, and community planning.',
              campuses: ['Mānoa', 'West Oʻahu', 'Maui College'],
            },
            {
              name: 'Physics',
              category: 'Science',
              description:
                'Deep dive into the fundamental principles of energy, thermodynamics, and materials science.',
              campuses: ['Mānoa', 'Hilo'],
            },
          ],
          marine: [
            {
              name: 'Marine Biology',
              category: 'Science',
              description:
                'Study marine organisms, their behaviors, and their interactions with the environment.',
              campuses: ['Mānoa', 'Hilo'],
            },
            {
              name: 'Global Env. Science (Ocean)',
              category: 'Science',
              description:
                "Focuses on the ocean's role in the global climate system.",
              campuses: ['Mānoa'],
            },
            {
              name: 'Veterinary Technology',
              category: 'Health',
              description:
                'Hands-on training to assist veterinarians in caring for animals.',
              campuses: ['WCC'],
            },
          ],
          music_coding: [
            {
              name: 'Computer Science (CS)',
              category: 'Technology',
              description:
                'The foundational route. Learn software engineering, AI, and data structures.',
              campuses: ['Mānoa', 'Hilo', 'West Oʻahu'],
            },
            {
              name: 'Music & Tech (Creative Media)',
              category: 'Arts',
              description:
                'A hybrid path focusing on digital sound production, audio engineering, and interactive media.',
              campuses: ['Mānoa (ACM)', 'West Oʻahu'],
            },
            {
              name: 'Electrical Engineering',
              category: 'Engineering',
              description:
                'For the hardware side. Learn to build synthesizers, audio processors, and the physical devices.',
              campuses: ['Mānoa'],
            },
          ],
          default: [],
        };

        const MOCK_AI_RESPONSES = {
          renewable:
            "Awesome! You can reach that goal through several paths at UH. I'd recommend looking into Environmental Engineering, Sustainable Science, or Physics.",
          marine:
            'Great choice! To help marine animals, you could study Marine Biology, Global Environmental Science with an ocean focus, or even Veterinary Technology.',
          music_coding:
            "That's a cool combo! You can blend those interests. A Computer Science degree is foundational, or you could explore Creative Media for music tech, or even Electrical Engineering for hardware.",
          default:
            "That's an interesting goal! While I don't have a specific path for that query in my demo, I can help you explore other areas like 'renewable energy' or 'marine animals'.",
        };

        const getPathStyle = (category = 'default') => {
          const cat = category.toLowerCase();
          if (cat.includes('engineering'))
            return {
              icon: Zap,
              color: 'bg-blue-500',
              textColor: 'text-blue-600',
            };
          if (cat.includes('science') || cat.includes('marine'))
            return {
              icon: Beaker,
              color: 'bg-cyan-500',
              textColor: 'text-cyan-600',
            };
          if (cat.includes('sustainable') || cat.includes('environment'))
            return {
              icon: Leaf,
              color: 'bg-green-500',
              textColor: 'text-green-600',
            };
          if (cat.includes('tech') || cat.includes('computer'))
            return {
              icon: Code,
              color: 'bg-indigo-600',
              textColor: 'text-indigo-600',
            };
          if (
            cat.includes('art') ||
            cat.includes('music') ||
            cat.includes('media')
          )
            return {
              icon: Palette,
              color: 'bg-rose-500',
              textColor: 'text-rose-600',
            };
          if (cat.includes('health') || cat.includes('vet'))
            return {
              icon: User,
              color: 'bg-emerald-500',
              textColor: 'text-emerald-600',
            };
          return {
            icon: Brain,
            color: 'bg-gray-500',
            textColor: 'text-gray-600',
          };
        };

        const getAiResponse = (query) => {
          return new Promise((resolve) => {
            const lowerQuery = query.toLowerCase();
            let key = 'default';

            if (
              lowerQuery.includes('renewable') ||
              lowerQuery.includes('energy') ||
              lowerQuery.includes('solar')
            ) {
              key = 'renewable';
            } else if (
              lowerQuery.includes('marine') ||
              lowerQuery.includes('ocean') ||
              lowerQuery.includes('animals')
            ) {
              key = 'marine';
            } else if (
              lowerQuery.includes('music') &&
              (lowerQuery.includes('coding') ||
                lowerQuery.includes('computer'))
            ) {
              key = 'music_coding';
            }

            const paths = (MOCK_PATHS[key] || []).map((path) => ({
              ...path,
              style: getPathStyle(path.category),
            }));

            const responseData = {
              conversationalResponse: MOCK_AI_RESPONSES[key],
              suggestedPaths: paths,
            };

            setTimeout(() => {
              resolve({ data: responseData, error: null });
            }, 1000);
          });
        };

        const handleSendQuery = async (query) => {
          setIsLoading(true);
          setAiResponse('');
          setApiError(null);
          setPaths([]);
          setUserQuery(query);

          const { data, error } = await getAiResponse(query);

          if (error) {
            setApiError(error);
            setAiResponse(error);
          } else {
            setAiResponse(data.conversationalResponse);
            setPaths(data.suggestedPaths);
          }
          setIsLoading(false);
        };

        return (
          <div className="min-h-screen bg-slate-50 flex flex-col">
            <header className="bg-white shadow-sm p-4 sticky top-0 z-20">
              <div className="max-w-5xl mx-auto flex justify-between items-center">
                <button
                  onClick={() => onNavigate('home')}
                  className="flex items-center space-x-2 text-gray-500 hover:text-blue-600"
                >
                  <Home size={20} />
                  <span className="font-medium">Home</span>
                </button>
                <div className="text-center">
                  <h1 className="text-2xl font-extrabold text-gray-900">
                    AI Advisor
                  </h1>
                </div>
                <div className="w-20"></div>
              </div>
            </header>

            <main className="flex-1 w-full max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-8 sm:py-12">
              <div className="space-y-8">
                {userQuery && (
                  <div className="max-w-2xl mx-auto">
                    <div className="flex items-start justify-end space-x-4">
                      <div className="bg-blue-600 text-white rounded-lg rounded-br-none shadow-md p-4">
                        <p>{userQuery}</p>
                      </div>
                      <div className="flex-shrink-0 w-10 h-10 rounded-full bg-gray-300 flex items-center justify-center text-gray-600">
                        <User size={20} />
                      </div>
                    </div>
                  </div>
                )}

                {isLoading && (
                  <div className="flex justify-center items-center py-10">
                    <div className="flex flex-col items-center space-y-3">
                      <Loader2 size={32} className="animate-spin text-blue-600" />
                      <p className="text-gray-500">Finding your path...</p>
                    </div>
                  </div>
                )}

                {aiResponse && !isLoading && (
                  <AiResponseBubble text={aiResponse} isError={!!apiError} />
                )}

                {paths.length > 0 && !isLoading && (
                  <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 pt-6">
                    {paths.map((path) => (
                      <PathCard key={path.name} path={path} />
                    ))}
                  </div>
                )}

                {!userQuery && !isLoading && (
                  <div className="text-center text-gray-500 pt-20">
                    <h2 className="text-2xl font-medium">Welcome!</h2>
                    <p className="text-lg">
                      What are you passionate about? What do you want to
                      achieve?
                    </p>
                    <p className="mt-4">
                      Ask the AI guide below to start your journey.
                    </p>
                  </div>
                )}
              </div>
            </main>

            <ChatInput onSend={handleSendQuery} loading={isLoading} />
          </div>
        );
      };

      /**
       * 6. Main App Component (Router)
       */
      const App = () => {
        const [currentPage, setCurrentPage] = useState('home'); // 'home' or 'chat'

        const navigate = (page) => {
          setCurrentPage(page);
        };

        if (currentPage === 'home') {
          return <HomePage onNavigate={navigate} />;
        }

        if (currentPage === 'chat') {
          return <ChatPage onNavigate={navigate} />;
        }

        return <HomePage onNavigate={navigate} />;
      };

      // --- 6. Render the App ---
      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(<App />);
    </script>
  </body>
</html>

